<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Schizofrenie</title>
    <link rel="stylesheet" href="game.css">
</head>

<body>
    <canvas id="gameSpace" width="1200" height="1200"></canvas>
    <button id="upperButton">↑</button>
    <button id="lefterButton">←</button>
    <button id="righterButton">→</button>
    <button id="downerButton">↓</button>

    <script>

        const upperButton = document.querySelector("upperButton");
        const lefterButton = document.querySelector("lefterButton");
        const righterButton = document.querySelector("righterButton");
        const downerButton = document.querySelector("downerButton");

        upperButton.addEventListener("click", tryMove("up"));
        lefterButton.addEventListener("click", tryMove("left"));
        righterButton.addEventListener("click", tryMove("right"));
        downerButton.addEventListener("click", tryMove("down"));

        document.body.addEventListener("keydown", e => handleKeyDown(e));
        const handleKeyDown = function (e) {
            switch (e.code) {
                case "ArrowUp":
                    tryMove('top'); break;      //up
                case "ArrowLeft":
                    tryMove('left'); break;     //left
                case "ArrowRight":
                    tryMove('right'); break;    //right
                case "ArrowDown":
                    tryMove('down'); break;     //down
            }
        }

        const tryMove = function (direction) {
            //todo: create and use a global variable if possible (control has to be on server side as well)
            if (notTurnedYet) {
                sendMove(direction);
            }
        }
        const sendMove = function (direction) {
            gameWebSocket.send(direction);
        }

        const gameWebSocket = new WebSocket("ws://localhost:8186");
        const gameSpace = document.querySelector("gameSpace");

        gameWebSocket.addEventListener("open", e => {
            //ask for the current state of the game and show it using canvas
        });

        gameWebSocket.addEventListener("error", e => {
            //learn what error it can be, how it can occur in the game and deal with it
        });

        gameWebSocket.addEventListener("message", e => {
            //handle information arriving from the server
            //only info messages from the server should be accepted here
        });
    </script>
</body>

</html>